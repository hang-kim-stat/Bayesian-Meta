rm(list = ls())
load("../../data/SimulationData_2.RData")
p_mu = length(true_mu)
Method_list = c("1_Benchmark","2_IPD-AD","3_IPD-AD-pooled","4_IPD_only")
Table1 = NULL
for (i_method in 1:length(Method_list)){
PostMean = PostVar = isCover1 = isCover2 = array(0,c(n_rep,2*p_mu))
for (rep_no in 1:n_rep){
load(paste0("../../output/Simulation_2/",Method_list[i_method],"/RData/rep_",rep_no,".RData"))
PostMean[rep_no,1:p_mu] = apply(posterior_mu,2,mean)
PostVar[rep_no,1:p_mu] = apply(posterior_mu,2,var)
for (i_var in 1:p_mu){
Post2_5 = quantile(posterior_mu[,i_var],probs=0.025)
Post97_5 = quantile(posterior_mu[,i_var],probs=0.975)
isCover1[rep_no,i_var] = (Post2_5<=true_mu[i_var]) && (true_mu[i_var]<=Post97_5)
} # for (i_var in 1:p_mu)
PostMean[rep_no,p_mu+(1:p_mu)] = apply(posterior_Sigma_theta,2,mean)
PostVar[rep_no,p_mu+(1:p_mu)] = apply(posterior_Sigma_theta,2,var)
for (i_var in 1:p_mu){
Post2_5 = quantile(posterior_Sigma_theta[,i_var],probs=0.025)
Post97_5 = quantile(posterior_Sigma_theta[,i_var],probs=0.975)
isCover1[rep_no,p_mu+i_var] = (Post2_5<=true_Sigma_theta[i_var]) && (true_Sigma_theta[i_var]<=Post97_5)
} # for (i_var in 1:p_mu)
} # for (rep_no in 1:n_rep)
RESULT = array(0,c(8,4))
dimnames(RESULT)[[1]] = c("mu1","mu2","mu3","mu4","Sig11","Sig22","Sig33","Sig44")
dimnames(RESULT)[[2]] = c("Est","Bias","MSE","CredCov95")
RESULT[,"Est"] = apply(PostMean,2,mean)
RESULT[,"Bias"] = apply(PostMean,2,mean)-c(true_mu,true_Sigma_theta)
for (i_var in 1:p_theta){
RESULT[i_var,"MSE"] = mean((PostMean[,i_var]-true_mu[i_var])^2)
}
for (i_var in 1:p_theta){
RESULT[p_theta+i_var,"MSE"] = mean((PostMean[,i_var]-true_Sigma_theta[i_var])^2)
}
RESULT[,"CredCov95"] = apply(isCover1,2,mean)
Table1 = cbind(Table1,RESULT)
} # for (i_method in 1:4)
round(Table1[,c(1,5,9,13)],2)
round(Table1[,c(3,7,11,15)]*100,2)
round(Table1[,c(4,8,12,16)]*100,1)
View(Table1)
