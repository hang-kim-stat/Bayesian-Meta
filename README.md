# **Supplementary Materials for ''Bayesian Random-Effects Meta-Analysis Integrating Individual Participant Data and Aggregate Data''**

This repository uses the template provided by [the JASA reproducibility materials template on GitHub](https://github.com/jasa-acs/repro-template).

## `Code` directory

The directory has R script files for simulation studies in Section 4 of the main text, the I-WIP meta-analysis study in Section 5, and the generation of figures and tables. 

### `Simulation_1` directory

The directory contains R codes for the simulation study in Section 4.1 to implement four methods: 
  - `Simulation_1/1_Benchmark.R` Random-effects analysis using all 40 simulation IPD studies
  - `Simulation_1/2_IPD-AD.R` **Proposed integrated random-effects analysis** with 10 IPD studies and 30 AD studies
  - `Simulation_1/3_IPD-AD-pooled.R` Proposed integrated random-effects analysis with a misspecified density ratio model
  - `Simulation_1/4_IPD_only.R` Random-effects analysis using only 10 IPD studies

**Input and output**
  - Each R script file uses the simulated data `Data/SimulationData_1.RData`
  - The default setting is to import the 1st simulated data file (out of 300 repeated simulations) and run the MCMC. 
      - A reviewer can fit a method to another simulated data file by changing `rep_no` (in Line 3 of each R code) to a number between 1 and 300.
      - The authors used a batch script to run the 300 repeated simulations in multiple cores in parallel.
  - Posterior values from the MCMC (after burn-in) are stored in `Output/Simulation_1/[Method]/RData` directory.
      - If you run the provided R code with the default setting, the output file for the 1st simulated data `rep_1.RData` will be produced.
      - For reviewer's convenience, the output files for all 300 simulation studies are already stored in the  `Output/Simulation_1/[Method]/RData` directory.
  - The current default setting `DrawDiagnostics = TRUE` on Line 14 of each R script file will produce the diagnostic plot of **μ** = E(**θ**<sub>l</sub>) (while running MCMC) and store it in `Output/Simulation_1/[Method]/DiagnosticPlot` directory.

### `Simulation_2` directory

The directory contains R codes for the simulation study in Section 4.2. Its structure is the same as that of the `Simulation_1` directory.

### `I-WIP_Application_CodeOnly.R` file

The R script was used to implement our proposed method on the real dataset for I-WIP meta-analysis study in Section 5. 
  - Due to public access restrictions, the data were not released here.
  - The complete dataset is available from the data custodian (OOO) at OOO@OOO, subject to the Terms and Conditions of Data Transfer.

## `Data` directory

The directory contains the two simulated data files (`SimulationData_1.RData` and `SimulationData_2.RData`) used for Sections 4.1 and 4.2 of the main text, respectively.
  - The data files were generated by running `Generate_Simulation_1.R` and `Generate_Simulation_2.R`.
  - `README.md` in the directory explains the variable names in the code by referring to the notations in the main text.  

## `Output` directory

### `Simulation_1` directory

`Simulation_1` directory contains the output of the four random effect models used in the simulation study of Section 4.1.

The directory for the [Method] random effect analysis  `Output/Simulation1/[Method]` contains two directories: 
  - `RData` directory
      - `rep_X.RData` contains 10,000 posterior draws of **μ** and **Σ** (after burn-in) for the X-th simulated data (out of 300). 
  - `DiagnosticPlot` directory
      -  The diagnostic plot of **μ** will be stored here (while running MCMC).

### `Simulation_2` directory

`Simulation_2` directory contains the output of the four random effect models used in the simulation study of Section 4.2. Its structure is the same as that of `Simulation_1` directory.

### `Application_Study` directory
  
The directory contains the outputs of the real data analysis in Section 5.
  - `Output/Application_Study/IPD_AD_Posterior.RData` contains the result of our proposed method (generated by the script `I-WIP_Application_CodeOnly.R`)
      - It contains 10,000 posterior draws of **μ** and **Σ** (after burn-in).  
  - `Output/Application_Study/IPDonly_Posterior.RData` contains the result of IPD-only analysis.
  - `Output/Application_Study/FixedEffect.xlsx` contains the result of the integrated fixed-effect analysis. 

### `Figure_Table` directory

The directory contains the tables in the Supplementary Material and the figures in the main text. 
  - `Output/Figure_Table/Supplement_Table4.csv` Table 4 of the Supplementary Material, generated with `Code/Figure_Table/Supplement_Table4.R`
  - `Output/Figure_Table/Supplement_Table5.csv` Table 5 of the Supplementary Material, generated with `Code/Figure_Table/Supplement_Table5.R`
  - `Output/Figure_Table/Maintext_Figure3.png` Figure 3 of the main text, generated with `Code/Figure_Table/Main_Figure3.R`
  - `Output/Figure_Table/Maintext_Figure3.png` Figure 3 of the main text, generated with `Code/Figure_Table/Main_Figure3.R`
